<head>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css">
     
    <!-- Promise polyfill script is required -->
    <!-- to use Mapbox GL Geocoder in IE 11. -->
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>
</head>
<% layout('layouts/boilerplate')%>
    <div id="cluster-map"></div>
    <h1>All Loaders</h1>
    <div>
        <p>
           <form action="/loaders" method="GET" class="form-inline">
               <div class="form-group">
                   <input type="text" name="search" placeholder="Coming Soon!" class="form-control">
                   <input type="submit" value="Search" class="btn btn-secondary">
               </div>
           </form> 
        </p>
        <!-- <a class="btn btn-info mb-2" href="/loaders/new">Add New Loader</a> -->
    </div>
    <div class="card-columns">
    
        <% for (let loader of loaders) {%>
            <div class="card mb-auto">
                <div class="row">
                    <div class="col-mg-6">
                       <div class="card-body">
                           <h5 class="card-title"><%= loader.company %></h5>
                           <h6 class="card-text"><%= loader.contact %></h6>
                           <h6 class="card-text"><%= loader.phone %></h6>
                           <h6 class="card-text"><%= loader.email %></h6>
                           <h6 class="card-text"><%=loader.location %></h6>
                           <a class="btn btn-primary"href="/loaders/<%=loader._id%>">View</a>
                       </div> 
                    </div>
                </div>

            </div>
        <% } %>
    
</div>

<script>
    const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
    const loaders = { features: <%- JSON.stringify(loaders) %>}
</script>

<script src="/javascripts/clusterMap.js"></script>